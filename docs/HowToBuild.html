<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Detroubulator $version$ - How to build Detroubulator</title>
		<link rel="stylesheet" type="text/css" href="styles/dtrb.css" />
	</head>
	<body>

		<div id="wrapper">

			<h1>Detroubulator $version$ - How to build Detroubulator</h1>
			<p>Every release of Detroubulator comes packaged with the full source code of that release. This document will help you navigate the source code and show you how to build Detroubulator yourself (it's easy!).</p>
	
			<h2>Contents of the source archive</h2>
			<p>The source archive contains the following files and directories:</p>
	
			<table class="emptytable" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td><code>abap/</code></td>
					<td>All ABAP source files.</td>
				</tr>
				<tr>
					<td><code>distfiles/</code></td>
					<td>Various files that go into the Detroubulator distribution.</td>
				</tr>
				<tr>
					<td><code>docs/</code></td>
					<td>Detroubulator documentation.</td>
				</tr>
				<tr>
					<td><code>etc/</code></td>
					<td>Miscellaneous files, currently contains the Detroubulator test file XML Schema and the XSLT stylesheet that creates the HTML output report.</td>
				</tr>
				<tr>
					<td><code>external/</code></td>
					<td>External libraries required to build and run Detroubulator.</td>
				</tr>
				<tr>
					<td><code>scripts/</code></td>
					<td>OS/shell-specific launch scripts.</td>
				</tr>
				<tr>
					<td><code>src/</code></td>
					<td>All non-test Java source files.</td>
				</tr>
				<tr>
					<td><code>tst/</code></td>
					<td>All unit test Java source files.</td>
				</tr>
				<tr>
					<td><code>build.xml</code></td>
					<td>Detroubulator's Ant buildfile.</td>
				</tr>
			</table>
	
			<h2>What you'll need</h2>
		<p>Detroubulator is written in the Java 6 programming language, which means that you'll need a Java 6 SDK in order to compile the source code. Sun's JDK 6.0 can be downloaded from <a href="http://java.sun.com/javase/downloads/index.jsp">java.sun.com</a>. Detroubulator is built using the Ant build tool. If you don't have Ant installed on your system, you can download it from <a href="http://ant.apache.org/">ant.apache.org</a>. We're using Ant version 1.6.5, but newer versions will <em>probably</em> also work. Furthermore, you'll need to acquire the following JAR files and place them in the <code>external</code> directory (which is initially empty):</p>
			<table class="stdtable" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<th>File</td>
					<th>How to get it</td>
				</tr>
				<tr>
					<td><code>aii_map_api.jar</code></td>
					<td>This file must be retrieved from the XI server. For more information on where to locate it, please refer to the <a href="FAQ.html#sapxi_1">FAQ</a>.</td>
				</tr>
				<tr>
					<td><code>sapjco.jar</code></td>
					<td>This file is part of the JCo installation. For more information on supported JCo versions, please refer to the <a href="FAQ.html#sapxi_7">FAQ</a>.</td>
				</tr>
				<tr>
					<td><code>junit-4.0.jar</code></td>
					<td>This file is part of the JUnit distribution, which can be downloaded from <a href="http://www.junit.org/">www.junit.org</a>. Detroubulator uses version 4.0, but newer versions will <em>probably</em> also work.</td>
				</tr>
				<tr>
					<td><code>easymock.jar</code></td>
					<td>This file is a part of the EasyMock distribution, which can be downloaded from <a href="http://www.easymock.org/">www.easymock.org</a>. Detroubulator uses EasyMock version 2.2, but newer versions will <em>probably</em> also work.</td>
				</tr>
			</table>
	
			<h2>Building with Ant</h2>
			<p>Compiling, testing and packaging Detroubulator is taken care of by targets in the <code>build.xml</code> buildfile. It contains the following targets:</p>
			<table class="stdtable" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<th>Target</th>
					<th>Description</th>
				</tr>
				<tr>
					<td><code>prepare</code></td>
					<td>Creates all directories required by the build.</td>
				</tr>
				<tr>
					<td><code>clean</code></td>
					<td>Removes all files and directories generated by Ant.</td>
				</tr>
				<tr>
					<td><code>compile</code></td>
					<td>Compiles all non-test source files.</td>
				</tr>
				<tr>
					<td><code>jar</code></td>
					<td>Generates the Detroubulator JAR archive.</td>
				</tr>
				<tr>
					<td><code>varsubst</code></td>
					<td>Replaces variables in all files within a single directory.</td>
				</tr>
				<tr>
					<td><code>dist</code></td>
					<td>Generates a release archive ready for distribution.</td>
				</tr>
				<tr>
					<td><code>compiletests</code></td>
					<td>Compiles all JUnit unit tests.</td>
				</tr>
				<tr>
					<td><code>runtests</code></td>
					<td>Executes all JUnit unit tests.</td>
				</tr>
			</table>
			<p>If you're new to the Ant build tool and would like to learn more, please consult the <a href="http://ant.apache.org/manual/index.html">Ant manual</a>. For more information on setting up Ant to execute JUnit tests, please refer to Ant's documentation of the <a href="http://ant.apache.org/manual/OptionalTasks/junit.html">JUnit task</a>.</p>
	
			<h2>Variable substitution</h2>
			<p>The documentation HTML files and the scripts in the <code>scripts</code> directory contain variables such as <code>&#36;version&#36;</code>. The purpose of these variables is to avoid hardcoding values that will change over time. When a Detroubulator distribution archive is created by the <code>dist</code> target, the variables are replaced with their current values. Variable substitution is performed by the <code>varsubst</code> target.</p>
	
			<h2>Package hierarchy</h2>
			<p>The Detroubulator source code is organised into the following packages:</p>
	
			<table class="stdtable" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<th>Package</td>
					<th>Contents</td>
				</tr>
				<tr>
					<td><code>org.detroubulator.core</code></td>
					<td>Detroubulator core classes and interfaces.</td>
				</tr>
				<tr>
					<td><code>org.detroubulator.mappingprograms</code></td>
					<td>Code that implements the various mapping programs supported by Detroubulator.</td>
				</tr>
				<tr>
					<td><code>org.detroubulator.reports</code></td>
					<td>Code that implements the various test reports supported by Detroubulator.</td>
				</tr>
				<tr>
					<td><code>org.detroubulator.server</code></td>
					<td>XI server interaction code.</td>
				</tr>
				<tr>
					<td><code>org.detroubulator.util</code></td>
					<td>Various utility classes and interfaces.</td>
				</tr>
			</table>
	
			<h2>Important classes and interfaces</h2>
			<p>The following is intended as a quick overview of the most important classes and interfaces in each Detroubulator package.</p>
			
			<h3><code>org.detroubulator.core</code></h3>
			<table class="stdtable" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<th>Name</th>
					<th>Type</th>
					<th>Description</th>
				</tr>
				<tr>
					<td><code>Detroubulator</code></td>
					<td>Class</td>
					<td>Contains various constants used throughout the application.</td>
				</tr>
				<tr>
					<td><code>Launcher</code></td>
					<td>Class</td>
					<td>This class is used to launch Detroubulator. It contains the application's only <code>main</code> method.</td>
				</tr>
				<tr>
					<td><code>TestSuite</code></td>
					<td>Class</td>
					<td>Contains the code that executes a remote mapping program, evaluates the mapping result against assertions, calls methods on test listeners etc.</td>
				</tr>
				<tr>
					<td><code>TestSuiteFactory</code></td>
					<td>Class</td>
					<td>Contains the code that parses the XML test file and returns a corresponding <code>TestSuite</code> object.</td>
				</tr>
				<tr>
					<td><code>Assertion</code></td>
					<td>Interface</td>
					<td>The interface that Detroubulator's assertion classes must implement.</td>
				</tr>
				<tr>
					<td><code>ContentAssertion</code></td>
					<td>Class</td>
					<td>An implementation of the <code>Assertion</code> interface. A content assertion is configured with an XPath expression. The assertion evaluates to true if the mapping result contains a document and the XPath expression evaluates to true against that document.</td>
				</tr>
				<tr>
					<td><code>ExceptionAssertion</code></td>
					<td>Class</td>
					<td>An implementation of the <code>Assertion</code> interface. The exception assertion evaluates to true if the mapping result contains a mapping failure.</td>
				</tr>
				<tr>
					<td><code>ValidationAssertion</code></td>
					<td>Class</td>
					<td>An implementation of the <code>Assertion</code> interface. The validation assertion evaluates to true if the mapping result is valid according to a specified schema.</td>
				</tr>
				<tr>
					<td><code>XPathScalar</code></td>
					<td>Class</td>
					<td>This class represents a scalar value of one of the scalar XPath data types (string, number and boolean).</td>
				</tr>
			</table>
			
			<h3><code>org.detroubulator.mappingprograms</code></h3>
			<table class="stdtable" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<th>Name</th>
					<th>Type</th>
					<th>Description</th>
				</tr>
				<tr>
					<td><code>MappingProgram</code></td>
					<td>Interface</td>
					<td>The interface that Detroubulator's mapping program classes must implement.</td>
				</tr>
				<tr>
					<td><code>MessageMapping</code></td>
					<td>Class</td>
					<td>This class represents a message mapping program. It implements the <code>MappingProgram</code> interface.</td>
				</tr>
				<tr>
					<td><code>XSLTMapping</code></td>
					<td>Class</td>
					<td>This class represents an XSLT mapping program. It implements the <code>MappingProgram</code> interface.</td>
				</tr>
				<tr>
					<td><code>JavaMapping</code></td>
					<td>Class</td>
					<td>This class represents a Java mapping program. It implements the <code>MappingProgram</code> interface.</td>
				</tr>

				<tr>
					<td><code>ABAPMapping</code></td>
					<td>Class</td>
					<td>This class represents an ABAP mapping program. It implements the <code>MappingProgram</code> interface.</td>
				</tr>
				<tr>
					<td><code>ABAPXSLTMapping</code></td>
					<td>Class</td>
					<td>This class represents an ABAP XSLT mapping program. It implements the <code>MappingProgram</code> interface.</td>
				</tr>
				<tr>
					<td><code>InterfaceMapping</code></td>
					<td>Class</td>
					<td>This class represents an interface mapping. It implements the <code>MappingProgram</code> interface.</td>
				</tr>
				<tr>
					<td><code>MappingInput</code></td>
					<td>Class</td>
					<td>This class represents a mapping program's input. It wraps an <code>InputStream</code> object.</td>
				</tr>
				<tr>
					<td><code>MappingOutput</code></td>
					<td>Class</td>
					<td>This class represent a mapping program's output. It wraps either a payload or a mapping program failure.</td>
				</tr>
				<tr>
					<td><code>MappingProgramFactory</code></td>
					<td>Class</td>
					<td>A factory class that creates <code>MappingProgram</code> instances.</td>
				</tr>
			</table>
			
			<h3><code>org.detroubulator.reports</code></h3>
			<table class="stdtable" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<th>Name</th>
					<th>Type</th>
					<th>Description</th>
				</tr>
				<tr>
					<td><code>TestListener</code></td>
					<td>Interface</td>
					<td>The listener interface for receiving test events.</td>
				</tr>
				<tr>
					<td><code>TestAdapter</code></td>
					<td>Class</td>
					<td>A convenience class containing empty implementations of every method in the <code>TestListener</code> interface.</td>
				</tr>
				<tr>
					<td><code>TestReport</code></td>
					<td>Interface</td>
					<td>The interface that Detroubulator's report classes must implement.</td>
				</tr>
				<tr>
					<td><code>TestReportFactory</code></td>
					<td>Class</td>
					<td>A factory class that creates <code>TestReport</code> instances.</td>
				</tr>
				<tr>
					<td><code>ConsoleOutputReport</code></td>
					<td>Class</td>
					<td>A report that writes test results to the console. It implements the <code>TestReport</code> interface.</td>
				</tr>
				<tr>
					<td><code>XmlOutputReport</code></td>
					<td>Class</td>
					<td>A report that writes test results to an XML document on disk. It implements the <code>TestReport</code> interface.</td>
				</tr>
				<tr>
					<td><code>HtmlOutputReport</code></td>
					<td>Class</td>
					<td>A report that writes test results to an HTML file on disk. It implements the <code>TestReport</code> interface.</td>
				</tr>
				<tr>
					<td><code>AudioPlaybackReport</code></td>
					<td>Class</td>
					<td>A report that plays one of two audio files, depending on whether the test completes with or without errors. It implements the <code>TestReport</code> interface.</td>
				</tr>
			</table>
			
			<h3><code>org.detroubulator.server</code></h3>
			<table class="stdtable" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<th>Name</th>
					<th>Type</th>
					<th>Description</th>
				</tr>
				<tr>
					<td><code>XIServer</code></td>
					<td>Interface</td>
					<td>An interface representing an SAP XI server.</td>
				</tr>
				<tr>
					<td><code>XIServerRFCImpl</code></td>
					<td>Class</td>
					<td>An implementation of the <code>XIServer</code> interface. Contains the code that communicates with the remote XI server using JCo.</td>
				</tr>
				<tr>
					<td><code>XIServerFactory</code></td>
					<td>Class</td>
					<td>A factory class that creates <code>XIServer</code> instances.</td>
				</tr>
				<tr>
					<td><code>InterfaceMappingStep</code></td>
					<td>Class</td>
					<td>Represents a mapping step of an interface mapping.</td>
				</tr>
			</table>
			
			<h3><code>org.detroubulator.util</code></h3>
			<table class="stdtable" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<th>Name</th>
					<th>Type</th>
					<th>Description</th>
				</tr>
				<tr>
					<td><code>Configurable</code></td>
					<td>Interface</td>
					<td>Instances of classes implementing this interface can be configured with a set of name/value pairs.</td>
				</tr>
				<tr>
					<td><code>Console</code></td>
					<td>Class</td>
					<td>Contains various static utility methods that make it easier to write to the console.</td>
				</tr>
				<tr>
					<td><code>XmlUtil</code></td>
					<td>Class</td>
					<td>Contains various static utility methods that make DOM parsing easier.</td>
				</tr>
			</table>

		</div>

	</body>
</html>